- name = "Elluin"
- levels = { wizard: 2 }
- hd = { wizard: 'd6' }
- ability_scores = {str: 8, dex: 16, con: 12, int: 16, wis: 14, cha: 8}
- mods = Hash[ability_scores.map { |k, v| [k, (v - 10) / 2] }]
- prof = ((levels.values.inject(&:sum) - 1) / 4 + 2)
- hp = 6 + (levels[:wizard] - 1) * 4 + mods[:con] * levels.values.inject(&:sum)
- xp = 340
- next_level = [0, 300, 900, 2700, 6500, 14000, 23000, 34000, 48000, 64000, 85000, 100000, 120000, 140000, 165000, 195000, 225000, 265000, 305000, 355000, '&#x221e;']
!!!
%head
  %title #{name}
  %link{rel: 'stylesheet', type: 'text/css', href: '../charsheet.css'}
%body
  %h1 #{name}
  .info-bar
    %span.subrace High Elf
    %span.class-level=levels.map { |k, v| "#{k.capitalize} #{v}"}.join('/')
    %span.xp (#{xp} / #{next_level.find{|t| t > xp}} xp)
  .flex.atf
    -#ability scores
    .ability-scores.flex.tall
      - ability_scores.each do |k, v|
        %div{class: k}
          .score=v
          .mod='%+d' % mods[k]
    -#proficiencies
    .proficiencies
      .head.b
        .bonus='%+d' % prof
      .save Int, Wis
      .skill Arcana, History, Investigation, Nature, Perception
      .tool none
      .language Common, Elvish, Gnomish, Draconic, Celestial
      .weapon dagger, dart, sling, quarterstaff, light crossbow, longsword, shortsword, shortbow, longbow
      .armor none
    -#health
    .health
      .head
        Max HP:
        %span.b=hp
      .hit-dice.resource
        .head Hit Dice
        - levels.each do |k, v|
          %div{class: "uses #{hd[k]}"}
            - levels[k].times do |i|
              .checkbox
      .death-saves.resource
        .head Death Saves
        .success.uses
          - 3.times do |i|
            .checkbox
        .failure.uses
          - 3.times do |i|
            .checkbox
    -#hp
    .hp
      .scratch
        .title Current HP
        %div
      .scratch
        .title Temp HP
        %div

  .flex.btf

    .flex.column.wide
      .half
        -#equip
        .equipment-set.block
          .head.b Ranged Equipment
          .small Longbow
          .ac
            .head.b AC
            .value=10 + mods[:dex]
          .move
            .head.b Move
            .value 30
          .head.b Attack Action
          .attack.roll
            .b.bg Roll
            .value d20 + #{mods[:dex] + prof}
          .attack.damage
            .b.bg Damage
            .value
              1d8 + #{mods[:dex]}
              %span.small piercing
          .attack.range
            .b.bg Range
            .value 150/600

        -#fey-ancestry
        .feature.block
          .head.b Fey Ancestry
          %p.small
            You have advantage on saving throws against being charmed, and magic can't put you to sleep.
        -#trance
        .feature.block
          .head.b Trance
          %p.small
            You don't need to sleep. After 4 hours of meditation, you gain the same beefit that a human does from 8 hours of sleep.

      .half
        -#equip
        .equipment-set.block
          .head.b Alternate Equipment
          .small Short sword, crystal
          .ac
            .head.b AC
            .value=10 + mods[:dex]
          .move
            .head.b Move
            .value 30
          .head.b Attack Action
          .attack.roll
            .b.bg Roll
            .value d20 + #{mods[:dex] + prof}
          .attack.damage
            .b.bg Damage
            .value
              1d6 + #{mods[:dex]}
              %span.small piercing
          .attack.range
            .b.bg Range
            .value 5
        -#darkvision
        .feature.block
          .head.b Darkvision
          %p.small
            You can see in dim light as though it were normal light, and darkness as though it were dim light, up to 60 ft. away.
        -#divination-savant
        .feature.block
          .head.b Divination Savant
          %p.small
            Copying a divination spell into your spellbook takes &#xbd; the cost in time and money.

      -#portent
      .feature.block
        .head.b Portent
        %p.small
          When you finish a long rest, roll two d20s and record the results. You can replace any attack roll, saving throw, or ability check made by you or a creature you can see with one of these foretelling rolls. You must choose to do so before the roll, and can only do this once per turn.
        %p.small
          Each roll can be used only once, and unused foretelling rolls are lost when you finish a long rest.


    .flex.tall.column.narrow
      -#wizard-spellcasting
      .spellcasting.block
        .head.b Wizard Spellcasting
        .stat.b
          Spellcasting Ability:
          .value Int
        .stat.b
          Spell Attack Modifier:
          .value='%+d' % (mods[:int] + prof)
        .stat.b
          Saving Throw DC:
          .value=8 + prof + mods[:int]
      .flex.block
        .head.b Spell Slots
        .slots.resource.half
          .label
            1
            %sup> st
          .uses
            - 3.times do |i|
              .checkbox
        .slots.resource.half
      .scratch.block
        .title.b Concentration
        %div
      .feature.block
        .head
          %span.b Arcane Recovery
          .uses
            .checkbox
        %p.small
          Once per day, when you finish a short rest, you can recover expended spell slots of 5<sup>th</sup> level or lower. These slots must have a combined level &#x2264; #{levels[:wizard] / 2 + (levels[:wizard] % 2)}.
      .feature.block
        .head.b Preparation
        %p.small
          After a long rest, you can prepare any #{levels[:wizard] + mods[:int]} spells from your spellbook.
      .feature.block
        .head.b Ritual Casting
        %p.small
          You can cast a wizard spell with the ritual tag as a ritual if it's in your spellbook.
      .feature.block
        .head.b Spellbook
        %p.small
          You have a spellbook. You may add two wizard spells to it for free whenever you gain a wizard level. If you find a wizard spell in your travels, you can add it to your spellbook by spending 2 hours and 50 gp worth of materials per spell level to copy it. You can only add spells of a level you can cast.

  .new-page

  .inventory.grid.block
    .head.b Inventory
    .item Spellbook
    .item Backpack
    .item Bedroll
    .item Rations (10)
    .item Waterskin
    .item Shortsword
    .item Longbow
    .item Crystal (focus)
    .item Ink pen
    .item Ink (1 oz.)
    .item Parchment (5)
    .item Quiver
    .item Arrow (25)
    .item Meteor shard
    .item
    .item
    .item
    .item
    .item
    .item
    .item
    .item
    .item
    .item
    .item
    .item
    .item
    .item
    .item
    .item
    .item
    .item
    .money
      .label.b.bg pp
      .label.b.bg gp
      .label.b.bg sp
      .label.b.bg cp
      .value.pp
      .value.gp 30
      .value.sp 2
      .value.cp 7

.spell-list.flex
  .spell-actions.column
    .head.b Spell Actions
    .spell
      .prepared
        .checkbox.checked
      .title Frostbite
      .level cantrip
      .keywords.b
    .spell
      .prepared
        .checkbox.checked
      .title Light
      .level cantrip
      .keywords.b
    .spell
      .prepared
        .checkbox.checked
      .title Minor Illusion
      .level cantrip
      .keywords.b
    .spell
      .prepared
        .checkbox.checked
      .title Prestidigitation
      .level cantrip
      .keywords.b
    .spell
      .prepared
        .checkbox
      .title Comprehend Languages
      .level 1<sup>st</sup>
      .keywords.b ritual
    .spell
      .prepared
        .checkbox
      .title Mage Armor
      .level 1<sup>st</sup>
      .keywords.b
    .spell
      .prepared
        .checkbox
      .title Protection from Evil and Good
      .level 1<sup>st</sup>
      .keywords.b conc.
    .spell
      .prepared
        .checkbox
      .title Sleep
      .level 1<sup>st</sup>
      .keywords.b

  .other-spells.column
    .head.b Reactions
    .spell
      .prepared
        .checkbox
      .title Feather Fall
      .level 1<sup>st</sup>
      .keywords.b
    .spell
      .prepared
        .checkbox
      .title Shield
      .level 1<sup>st</sup>
      .keywords.b
    .head.b Non-Combat Spells
    .spell
      .prepared
        .checkbox
      .title Find Familiar
      .level 1<sup>st</sup>
      .keywords.b ritual
    .spell
      .prepared
        .checkbox
      .title Identify
      .level 1<sup>st</sup>
      .keywords.b ritual

.flex

  .half.flex.tall
    .feature.block
      .head.b Personality Trait
      %p.small
        I'm willing to listen to every side of an argument before I make my own judgment.
    .feature.block
      .head.b Ideal: Beauty
      %p.small
        What is beautiful points us beyond itself toward what is true.
    .feature.block
      .head.b Bond
      %p.small
        I've been searching my whole life for the location and meaning of the "Blue Star".
    .feature.block
      .head.b Flaw
      %p.small
        Unlocking an ancient mystery is worth the price of a civilization.

  .companion.half.flex.tall
    .head.b Owl Familiar
    .combat-stats
      .ac 11
      .hp 1
      .move 5 ft., fly 60 ft.
    .ability-scores.flex
      .str -4
      .dex +1
      .con -1
      .int -4
      .wis -1
      .cha -2
    .other-stats
      .skills Perception +3, Stealth +3
      .senses darkvision 120 ft.
    .features
      .flyby
        %span.b Flyby.
        The owl doesn't provoke opportunity attacks when it flies out of an enemy's reach.
      .keen-hearing-and-sight
        %span.b Keen Hearing and Sight.
        The owl has advantage on Wisdom (Perception) checks that rely on hearing or sight.

  .flex
    .feature.block
      .head.b Background: Cloistered Scholar
      %p.small
        As a child, you were inquisitive when your playmates were possessive or raucous. In your formative years, you found your way to a great library of Gulnost, where you were apprenticed and taught that knowledge is more valuable than gold or gems. Now you are ready to leave your home&mdash;not to abandon it, but to quest for new lore.
      %p.small
        %span.title Specialty:
        Astronomer
