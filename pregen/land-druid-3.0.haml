- name = "Suthalion"
- levels = { druid: 3 }
- hd = { druid: 'd8' }
- ability_scores = {str: 9, dex: 16, con: 10, int: 12, wis: 16, cha: 12}
- mods = Hash[ability_scores.map { |k, v| [k, (v - 10) / 2] }]
- prof = ((levels.values.sum - 1) / 4 + 2)
- hp = 8 + (levels[:druid] - 1) * 5 + mods[:con] * levels[:druid]
!!!
%head
  %title #{name}
  %link{rel: 'stylesheet', type: 'text/css', href: '../charsheet.css'}
%body
  %h1 #{name}
  .info-bar
    %span.subrace Wood Elf
    %span.class-level=levels.map { |k, v| "#{k.capitalize} #{v}"}.join('/')
    %span.xp (900 / 2,700 xp)
  .flex.atf
    -#ability scores
    .ability-scores.flex.tall
      - ability_scores.each do |k, v|
        %div{class: k}
          .score=v
          .mod='%+d' % mods[k]
    -#proficiencies
    .proficiencies
      .head.b
        .bonus='%+d' % prof
      .save Int, Wis
      .skill Athletics, Medicine, Nature, Perception, Survival
      .tool Herbalism kit, Musical instrument (horn)
      .language Common, Druidic, Elvish, Sylvan
      .weapon shortsword, longsword, shortbow, longbow, club, dagger, dart, javelin, mace, quarterstaff, scimitar, sickle, sling, spear
      .armor light, medium, shields
    -#health
    .health
      .head
        Max HP:
        %span.b=hp
      .hit-dice.resource
        .head Hit Dice
        - levels.each do |k, v|
          %div{class: "uses #{hd[k]}"}
            - levels[k].times do |i|
              .checkbox
      .death-saves.resource
        .head Death Saves
        .success.uses
          - 3.times do |i|
            .checkbox
        .failure.uses
          - 3.times do |i|
            .checkbox
    -#hp
    .hp
      .scratch
        .title Current HP
        %div
      .scratch
        .title Temp HP
        %div

  .flex.btf

    .flex.column.wide
      -#equip
      .equipment-set.half.block
        .head.b Melee Equipment
        .small Shortsword, hide armor
        .ac
          .head.b AC
          .value 14
        .move
          .head.b Move
          .value 35
        .head.b Attack Action
        .attack.roll
          .b.bg Roll
          .value d20 + #{mods[:dex] + prof}
        .attack.damage
          .b.bg Damage
          .value
            1d6 + #{mods[:dex]}
            %span.small piercing
        .attack.range
          .b.bg Range
          .value 5
      -#equip
      .equipment-set.half.block
        .head.b Ranged Equipment
        .small Shortbow, hide armor
        .ac
          .head.b AC
          .value 14
        .move
          .head.b Move
          .value 35
        .head.b Ranged Attack
        .attack.roll
          .b.bg Roll
          .value d20 + #{mods[:dex] + prof}
        .attack.damage
          .b.bg Damage
          .value
            1d6 + #{mods[:dex]}
            %span.small piercing
        .attack.range
          .b.bg Range
          .value 80 / 320
      .half
        .feature.block
          .head.b Darkvision
          %p.small
            You can see in dim light as though it were normal light, and darkness as though it were dim light, up to 60 ft. away.
      .half
        .feature.block
          .head.b Fey Ancestry
          %p.small
            You have advantage on saving throws against being charmed, and magic can't put you to sleep.
      .feature.block
        .head
          %span.b Wild Shape
          .uses.short-rest
            - 2.times do |i|
              .checkbox
        .small
          %p
            %span.b Action.
            Assume the shape of a beast you have seen before with a challenge rating of &#xbc; or lower. It cannot have a flying or swimming speed.
          %p
            The transformation ends after #{levels[:druid] / 2} hours unless you expend another use of this feature, or when you fall unconscious, drop to 0 hit points, or die. You can revert to your normal form earlier by using a bonus action on your turn.
          %p
            Your game statistics are replaced by your new form, other than your Int, Wis, and Cha. You also retain your skill and saving throw proficiencies, in addition to gaining those of the beast form. You do not gain any legendary or lair actions.
          %p
            You assume the beast form's hit points and Hit Dice. When you revert, you return to the hit points you had before transforming. If you revert as a result of dropping to 0 hit points, any excess damage carries over to your normal form.
          %p
            You can't cast spells in your beast form, and your ability to speak or take actions that require hands is limited to the capabilities of your beast form. Transforming does not break your concentration or prevent you from taking actions that are part of a spell that you already cast.
          %p
            You retain the benefit of your other features and can use them if the beast form is physically capable of doing so. You lose darkvision in your beast form unless the new form has darkvision also.
          %p
            Your equipment can merge into your new form or drop into the space you are in. Merged equipmet has no effect until you leave the form. You can also have your new form wear any equipment that is practical for its size and shape.

    .flex.tall.column.narrow{style: "margin-top: -2rem;"}
      -#druid-spellcasting
      .spellcasting.block
        .head.b Druid Spellcasting
        .stat.b
          Spellcasting Ability:
          .value Wis
        .stat.b
          Spell Attack Modifier:
          .value='%+d' % (mods[:wis] + prof)
        .stat.b
          Saving Throw DC:
          .value=8 + prof + mods[:wis]
      .flex.block
        .head.b Spell Slots
        .slots.resource.half
          .label
            1
            %sup> st
          .uses
            - 4.times do |i|
              .checkbox
        .slots.resource.half
          .label
            2
            %sup> nd
          .uses
            - 2.times do |i|
              .checkbox
      .scratch.block
        .title.b Concentration
        %div
      .feature.block
        .head.b Preparation
        %p.small
          You always have
          %span.spell spider climb
          and
          %span.spell spike growth
          prepared. After a long rest, you can prepare any #{levels[:druid] + mods[:wis]} spells from the druid spell list.
      .feature.block
        .head.b Ritual Casting
        %p.small
          You can cast a prepared druid spell with the ritual tag as a ritual.
      .feature.block
        .head
          %span.b Natural Recovery
          .uses
            .checkbox
        %p.small
          Once per day, when you finish a short rest, you can recover expended spell slots of 5<sup>th</sup> level or lower. These slots must have a combined level &#x2264; #{levels[:druid] / 2 + (levels[:druid] % 2)}.
      .feature.block
        .head.b Trance
        %p.small
          You don't need to sleep. After 4 hours of meditation, you gain the benefit of a full night's sleep.
      .feature.block
        .head.b Mask of the Wild
        %p.small
          You can attempt to hide even when you are only lightly obscured by foliage, heavy rain, falling snow, mist, and other natural phenomena.
 


  .new-page

  .inventory.grid.block
    .head.b Inventory
    .item Hide armor
    .item Shortsword
    .item Shortbow
    .item Arrow (20)
    .item Sprig of mistletoe
    .item Waterskin
    .item Healer's kit
    .item Quiver
    .item Herbalism kit
    .item Fishing tackle
    .item Backpack
    .item Mess kit
    .item Blanket
    .item Common clothes
    .item
    .item
    .item
    .item
    .item
    .item
    .item
    .item
    .item
    .item
    .item
    .item
    .item
    .item
    .item
    .item
    .item
    .item
    .money
      .label.b.bg pp
      .label.b.bg gp
      .label.b.bg sp
      .label.b.bg cp
      .value.pp
      .value.gp 5
      .value.sp
      .value.cp

  .spell-list.flex
    .spell-actions.column
      .head.b Spell Actions
      .spell
        .prepared
          .checkbox.checked
        .title Druidcraft
        .level cantrip
        .keywords.b 
      .spell
        .prepared
          .checkbox.checked
        .title Frostbite
        .level cantrip
        .keywords.b 
      .spell
        .prepared
          .checkbox.checked
        .title Guidance
        .level cantrip
        .keywords.b conc.
      .spell
        .prepared
          .checkbox
        .title Animal Friendship
        .level 1<sup>st</sup>
        .keywords.b 
      .spell
        .prepared
          .checkbox
        .title Beast Bond
        .level 1<sup>st</sup>
        .keywords.b conc.
      .spell
        .prepared
          .checkbox
        .title Charm Person
        .level 1<sup>st</sup>
        .keywords.b 
      .spell
        .prepared
          .checkbox
        .title Create or Destroy Water
        .level 1<sup>st</sup>
        .keywords.b 
      .spell
        .prepared
          .checkbox
        .title Cure Wounds
        .level 1<sup>st</sup>
        .keywords.b 
      .spell
        .prepared
          .checkbox
        .title Detect Magic
        .level 1<sup>st</sup>
        .keywords.b conc., ritual
      .spell
        .prepared
          .checkbox
        .title Detect Poison and Disease
        .level 1<sup>st</sup>
        .keywords.b conc.
      .spell
        .prepared
          .checkbox
        .title Earth Tremor
        .level 1<sup>st</sup>
        .keywords.b 
      .spell
        .prepared
          .checkbox
        .title Entangle
        .level 1<sup>st</sup>
        .keywords.b conc.
      .spell
        .prepared
          .checkbox
        .title Faerie Fire
        .level 1<sup>st</sup>
        .keywords.b conc.
      .spell
        .prepared
          .checkbox
        .title Fog Cloud
        .level 1<sup>st</sup>
        .keywords.b conc.
      .spell
        .prepared
          .checkbox
        .title Goodberry
        .level 1<sup>st</sup>
        .keywords.b 
      .spell
        .prepared
          .checkbox
        .title Ice Knife
        .level 1<sup>st</sup>
        .keywords.b 
      .spell
        .prepared
          .checkbox
        .title Jump
        .level 1<sup>st</sup>
        .keywords.b 
      .spell
        .prepared
          .checkbox
        .title Longstrider
        .level 1<sup>st</sup>
        .keywords.b 
      .spell
        .prepared
          .checkbox
        .title Purify Food and Drink
        .level 1<sup>st</sup>
        .keywords.b ritual
      .spell
        .prepared
          .checkbox
        .title Speak with Animals
        .level 1<sup>st</sup>
        .keywords.b ritual
      .spell
        .prepared
          .checkbox
        .title Thunderwave
        .level 1<sup>st</sup>
        .keywords.b 
      .spell
        .prepared
          .checkbox
        .title Animal Messenger
        .level 2<sup>nd</sup>
        .keywords.b ritual
      .spell
        .prepared
          .checkbox
        .title Barkskin
        .level 2<sup>nd</sup>
        .keywords.b conc.
      .spell
        .prepared
          .checkbox
        .title Beast Sense
        .level 2<sup>nd</sup>
        .keywords.b conc., ritual
      .spell
        .prepared
          .checkbox
        .title Darkvision
        .level 2<sup>nd</sup>
        .keywords.b 
      .spell
        .prepared
          .checkbox
        .title Dust Devil
        .level 2<sup>nd</sup>
        .keywords.b conc.
      .spell
        .prepared
          .checkbox
        .title Earthbind
        .level 2<sup>nd</sup>
        .keywords.b conc.

    .other-spells.column{style: "margin-top:1.5rem;"}
      .spell
        .prepared
          .checkbox
        .title Enhance Ability
        .level 2<sup>nd</sup>
        .keywords.b conc.
      .spell
        .prepared
          .checkbox
        .title Find Traps
        .level 2<sup>nd</sup>
        .keywords.b 
      .spell
        .prepared
          .checkbox
        .title Flaming Sphere
        .level 2<sup>nd</sup>
        .keywords.b conc.
      .spell
        .prepared
          .checkbox
        .title Gust of Wind
        .level 2<sup>nd</sup>
        .keywords.b conc.
      .spell
        .prepared
          .checkbox
        .title Heat Metal
        .level 2<sup>nd</sup>
        .keywords.b conc.
      .spell
        .prepared
          .checkbox
        .title Hold Person
        .level 2<sup>nd</sup>
        .keywords.b conc.
      .spell
        .prepared
          .checkbox
        .title Lesser Restoration
        .level 2<sup>nd</sup>
        .keywords.b 
      .spell
        .prepared
          .checkbox
        .title Locate Animals or Plants
        .level 2<sup>nd</sup>
        .keywords.b ritual
      .spell
        .prepared
          .checkbox
        .title Locate Object
        .level 2<sup>nd</sup>
        .keywords.b conc.
      .spell
        .prepared
          .checkbox
        .title Moonbeam
        .level 2<sup>nd</sup>
        .keywords.b conc.
      .spell
        .prepared
          .checkbox
        .title Pass Without Trace
        .level 2<sup>nd</sup>
        .keywords.b conc.
      .spell
        .prepared
          .checkbox
        .title Protection from Poison
        .level 2<sup>nd</sup>
        .keywords.b 
      .spell
        .prepared
          .checkbox
        .title Skywrite
        .level 2<sup>nd</sup>
        .keywords.b conc., ritual
      .spell
        .prepared
          .checkbox.checked
        .title Spider Climb
        .level 2<sup>nd</sup>
        .keywords.b conc.
      .spell
        .prepared
          .checkbox.checked
        .title Spike Growth
        .level 2<sup>nd</sup>
        .keywords.b conc.
      .spell
        .prepared
          .checkbox
        .title Warding Wind
        .level 2<sup>nd</sup>
        .keywords.b conc.
 
      .head.b Bonus Actions
      .spell
        .prepared
          .checkbox
        .title Healing Word
        .level 1<sup>st</sup>
        .keywords.b 
      .spell
        .prepared
          .checkbox
        .title Flame Blade
        .level 2<sup>nd</sup>
        .keywords.b conc.
      .spell
        .prepared
          .checkbox
        .title Healing Spirit
        .level 2<sup>nd</sup>
        .keywords.b conc.
      .head.b Reactions
      .spell
        .prepared
          .checkbox
        .title Absorb Elements
        .level 1<sup>st</sup>
        .keywords.b 
      .head.b Non-Combat Spells
      .spell
        .prepared
          .checkbox
        .title Snare
        .level 1<sup>st</sup>
        .keywords.b 

  .new-page

  .flex.role-playing
    .column.wide.background
      .feature.block
        .head.b Background: Outlander
        %p.small
          You grew up in the wilds on the slops of Minhelras, far from civilization and the comforts of technology. You've survived weather more extreme than any city-dweller could comprehend, and enjoyed the solitude of being the only thinking creature for miles in any direction. The mountain is in your blood.
        %p.small
          You have an excellent memory for geography, and you can always recall the general layout of terrain, settlements, and other features around you. You can find food and fresh water for youreslf and up to five other people each day, provide the land offers berries, small game, water, and so forth.
    .column.narrow.personality
      .feature.block
        .head.b Personality Trait
        %p.small
          I have a lesson for every situation, drawn from observing nature.
      .feature.block
        .head.b Ideal: Change
        %p.small
          Life is like the seasons, in constant change, and we must change with it.
      .feature.block
        .head.b Bond
        %p.small
          An injury to the unspoiled wilderness of Minhelras is an injury to me.
      .feature.block
        .head.b Flaw
        %p.small
          I am slow to trust members of other races, tribes, and societies.
